# NFR要件 - 3Dアバター機能

## 1. 概要

本ドキュメントでは、3Dアバター機能の非機能要件を定義します。

---

## 2. パフォーマンス要件

### NFR-001: VRMファイルサイズ制限

| 項目 | 値 |
|------|-----|
| 最大ファイルサイズ | 20MB |
| 推奨ファイルサイズ | 10MB以下 |
| 検証方法 | アップロード時のファイルサイズチェック |

**実装方針**:
- manifest.jsonでモデルパスを定義する際、ファイルサイズの目安を記載
- 将来的にアップロード機能を追加する場合、20MB制限を実装

### NFR-002: レンダリングフレームレート

| 項目 | 値 |
|------|-----|
| 目標フレームレート | 30fps |
| 最低フレームレート | 24fps |

**実装方針**:
- requestAnimationFrameを使用し、ブラウザのリフレッシュレートに依存
- 30fps固定ではなく、ブラウザの標準動作に任せる
- 重い処理がある場合はフレームスキップを許容

---

## 3. 互換性要件

### NFR-003: ブラウザサポート

| ブラウザ | バージョン | サポートレベル |
|----------|-----------|---------------|
| Chrome | 最新版 | 完全サポート |
| Firefox | - | 非サポート |
| Edge | - | 非サポート |
| Safari | - | 非サポート |

**実装方針**:
- Chrome最新版でのみ動作確認を実施
- 他ブラウザでの動作は保証しない
- WebGL 2.0を前提とする

### NFR-004: WebGL非対応時の動作

| 状況 | 動作 |
|------|------|
| WebGL非対応 | エラーメッセージを表示 |
| WebGL無効化 | エラーメッセージを表示 |

**実装方針**:
- WebGL対応チェックを実施
- 非対応の場合は「お使いのブラウザは3Dアバター機能に対応していません」等のメッセージを表示
- フォールバック機能は実装しない

---

## 4. スケーラビリティ要件

### NFR-005: 同時接続ユーザー数

| 項目 | 値 |
|------|-----|
| 想定同時接続数 | 10人未満 |
| スケール対応 | 不要 |

**実装方針**:
- 小規模チームでの利用を想定
- CDNキャッシュは標準設定で十分
- 特別なスケーリング対策は不要

---

## 5. キャッシュ要件

### NFR-006: VRMモデルキャッシュ

| 項目 | 値 |
|------|-----|
| キャッシュ方式 | ブラウザキャッシュ |
| キャッシュ期間 | ブラウザデフォルト |

**実装方針**:
- Service WorkerやIndexedDBは使用しない
- ブラウザの標準キャッシュ機能に依存
- VRMファイルは静的アセットとして配信（Cache-Controlヘッダーで制御）

---

## 6. 要件サマリー

| ID | 要件 | 値 | 優先度 |
|----|------|-----|--------|
| NFR-001 | VRMファイルサイズ | 20MB以下 | 高 |
| NFR-002 | フレームレート | 30fps | 中 |
| NFR-003 | ブラウザサポート | Chrome最新版のみ | 高 |
| NFR-004 | WebGL非対応時 | エラー表示 | 高 |
| NFR-005 | 同時接続数 | 10人未満 | 低 |
| NFR-006 | キャッシュ | ブラウザキャッシュ | 低 |

---

## 7. 実装への影響

上記NFR要件に基づき、以下の実装方針を採用します：

1. **シンプルな実装**: Service Worker、IndexedDB等の複雑なキャッシュ機構は不要
2. **Chrome専用**: 他ブラウザ対応のためのポリフィルやフォールバックは不要
3. **エラーハンドリング**: WebGL非対応時はエラーメッセージのみ表示
4. **パフォーマンス**: 30fps目標だが、ブラウザ標準動作に任せる
