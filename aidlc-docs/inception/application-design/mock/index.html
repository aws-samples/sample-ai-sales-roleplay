<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3Dアバター機能 - モック</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="app-container">
    <!-- ヘッダー -->
    <header class="header">
      <h1>AI営業ロールプレイ - 3Dアバターモック</h1>
      <div class="header-actions">
        <button class="btn btn-secondary" onclick="toggleTheme()">🌙 テーマ切替</button>
      </div>
    </header>

    <!-- メインコンテンツ -->
    <main class="main-content">
      <!-- 左サイドバー: コントロールパネル -->
      <aside class="control-panel">
        <h2>コントロールパネル</h2>

        <!-- アバター選択 -->
        <section class="control-section">
          <h3>アバター選択 (AvatarSelector)</h3>
          <div class="avatar-selector" id="avatarSelector">
            <!-- JavaScriptで動的生成 -->
          </div>
        </section>

        <!-- メトリクス調整 -->
        <section class="control-section">
          <h3>メトリクス (0-10)</h3>
          <div class="metric-control">
            <label for="angerLevel">怒りレベル: <span id="angerValue">3</span></label>
            <input type="range" id="angerLevel" min="0" max="10" value="3" oninput="updateMetrics()">
          </div>
          <div class="metric-control">
            <label for="trustLevel">信頼度: <span id="trustValue">5</span></label>
            <input type="range" id="trustLevel" min="0" max="10" value="5" oninput="updateMetrics()">
          </div>
          <div class="metric-control">
            <label for="progressLevel">進捗度: <span id="progressValue">4</span></label>
            <input type="range" id="progressLevel" min="0" max="10" value="4" oninput="updateMetrics()">
          </div>
        </section>

        <!-- 発話制御 -->
        <section class="control-section">
          <h3>発話制御</h3>
          <button class="btn btn-primary" id="speakBtn" onclick="toggleSpeaking()">
            🔊 発話開始
          </button>
          <p class="status-text">状態: <span id="speakingStatus">停止中</span></p>
        </section>

        <!-- 感情状態表示 -->
        <section class="control-section">
          <h3>計算された感情状態</h3>
          <div class="emotion-display" id="emotionDisplay">
            <span class="emotion-emoji">😐</span>
            <span class="emotion-label">neutral</span>
          </div>
        </section>
      </aside>

      <!-- 中央: アバター表示エリア -->
      <section class="avatar-area">
        <div class="vrm-avatar-container" id="vrmAvatarContainer">
          <!-- WebGLチェック結果 -->
          <div class="webgl-status" id="webglStatus"></div>

          <!-- アバター表示エリア（モック） -->
          <div class="avatar-display" id="avatarDisplay">
            <div class="avatar-placeholder" id="avatarPlaceholder">
              <div class="avatar-face" id="avatarFace">
                <div class="avatar-eyes">
                  <div class="eye left" id="eyeLeft"></div>
                  <div class="eye right" id="eyeRight"></div>
                </div>
                <div class="avatar-mouth" id="avatarMouth"></div>
              </div>
              <div class="avatar-body"></div>
            </div>

            <!-- 発話インジケーター -->
            <div class="speaking-indicator" id="speakingIndicator" hidden>
              <span class="speaker-icon">🔊</span>
              <span class="speaking-text">発話中...</span>
            </div>
          </div>

          <!-- ローディング表示 -->
          <div class="loading-overlay" id="loadingOverlay" hidden>
            <div class="spinner"></div>
            <p>アバターをロード中...</p>
          </div>

          <!-- エラー表示 -->
          <div class="error-display" id="errorDisplay" hidden>
            <p class="error-message"></p>
            <button class="btn btn-secondary" onclick="retryLoad()">再試行</button>
          </div>
        </div>

        <!-- アバター情報 -->
        <div class="avatar-info" id="avatarInfo">
          <h3>現在のアバター</h3>
          <p>ID: <span id="currentAvatarId">default</span></p>
          <p>名前: <span id="currentAvatarName">デフォルトアバター</span></p>
        </div>
      </section>

      <!-- 右サイドバー: コンポーネント構造 -->
      <aside class="component-tree">
        <h2>コンポーネント構造</h2>
        <div class="tree-view">
          <div class="tree-node active">
            <span class="node-icon">📄</span>
            <span class="node-name">ConversationPage</span>
          </div>
          <div class="tree-node indent-1">
            <span class="node-icon">🔧</span>
            <span class="node-name">AvatarProvider</span>
          </div>
          <div class="tree-node indent-2 active">
            <span class="node-icon">📦</span>
            <span class="node-name">VRMAvatarContainer</span>
          </div>
          <div class="tree-node indent-3">
            <span class="node-icon">🎨</span>
            <span class="node-name">VRMAvatar</span>
          </div>
          <div class="tree-node indent-4">
            <span class="node-icon">📥</span>
            <span class="node-name">VRMLoader</span>
          </div>
          <div class="tree-node indent-4">
            <span class="node-icon">😊</span>
            <span class="node-name">ExpressionController</span>
          </div>
          <div class="tree-node indent-4">
            <span class="node-icon">👄</span>
            <span class="node-name">LipSyncController</span>
          </div>
          <div class="tree-node indent-4">
            <span class="node-icon">🎬</span>
            <span class="node-name">AnimationController</span>
          </div>
        </div>

        <h3>サービス</h3>
        <div class="tree-view">
          <div class="tree-node">
            <span class="node-icon">⚙️</span>
            <span class="node-name">AvatarService</span>
          </div>
          <div class="tree-node">
            <span class="node-icon">🔊</span>
            <span class="node-name">AudioService</span>
          </div>
          <div class="tree-node">
            <span class="node-icon">🗣️</span>
            <span class="node-name">PollyService</span>
          </div>
        </div>

        <h3>データフロー</h3>
        <div class="data-flow">
          <div class="flow-item">
            <span class="flow-label">Props</span>
            <span class="flow-arrow">→</span>
            <span class="flow-data">avatarId, metrics, isSpeaking</span>
          </div>
          <div class="flow-item">
            <span class="flow-label">Callback</span>
            <span class="flow-arrow">←</span>
            <span class="flow-data">onEmotionChange</span>
          </div>
          <div class="flow-item">
            <span class="flow-label">Context</span>
            <span class="flow-arrow">↔</span>
            <span class="flow-data">avatarInfo, isLoading</span>
          </div>
        </div>
      </aside>
    </main>

    <!-- フッター: ログ表示 -->
    <footer class="log-panel">
      <h3>イベントログ</h3>
      <div class="log-container" id="logContainer">
        <div class="log-entry info">[INFO] モック初期化完了</div>
      </div>
    </footer>
  </div>

  <script src="app.js"></script>
</body>

</html>